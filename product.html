{% extends "base.html" %}

{% block title %}{{ product.name }} | {{ product.category }} | {{ shop_name }}{% endblock %}

{% block extra_css %}
<style>
    /* Product Page */
    .product-page {
        padding: 40px 0 80px;
    }
    
    .product-breadcrumb {
        margin-bottom: 30px;
    }
    
    .breadcrumb-list {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 0.9rem;
        color: var(--text-secondary);
    }
    
    .breadcrumb-item {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .breadcrumb-item:not(:last-child)::after {
        content: '/';
        color: var(--text-tertiary);
    }
    
    .breadcrumb-link {
        color: var(--text-secondary);
        transition: color var(--transition-fast);
    }
    
    .breadcrumb-link:hover {
        color: var(--gold);
    }
    
    .breadcrumb-current {
        color: var(--gold);
        font-weight: 500;
    }
    
    /* Product Layout */
    .product-layout {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 60px;
        margin-bottom: 60px;
    }
    
    @media (max-width: 992px) {
        .product-layout {
            grid-template-columns: 1fr;
            gap: 40px;
        }
    }
    
    /* Product Gallery */
    .product-gallery {
        position: sticky;
        top: calc(var(--header-height) + 20px);
    }
    
    .gallery-main {
        position: relative;
        margin-bottom: 20px;
        border-radius: var(--radius-xl);
        overflow: hidden;
        box-shadow: var(--shadow-lg);
    }
    
    .gallery-image {
        width: 100%;
        height: 600px;
        object-fit: cover;
        transition: transform var(--transition-slow);
        cursor: zoom-in;
    }
    
    .gallery-image:hover {
        transform: scale(1.02);
    }
    
    .gallery-actions {
        position: absolute;
        top: 20px;
        right: 20px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        z-index: 2;
    }
    
    .gallery-btn {
        width: 44px;
        height: 44px;
        background: var(--card-bg);
        border-radius: var(--radius-full);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-primary);
        transition: all var(--transition-fast);
        box-shadow: var(--shadow-md);
    }
    
    .gallery-btn:hover {
        background: var(--gold);
        color: var(--text-inverse);
        transform: scale(1.1);
    }
    
    .gallery-thumbs {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
    }
    
    .thumb-item {
        position: relative;
        border-radius: var(--radius-lg);
        overflow: hidden;
        cursor: pointer;
        aspect-ratio: 1;
        background: var(--surface-bg);
        transition: all var(--transition-fast);
    }
    
    .thumb-item:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-md);
    }
    
    .thumb-item.active {
        border: 2px solid var(--gold);
        transform: translateY(-5px);
        box-shadow: var(--shadow-gold);
    }
    
    .thumb-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    /* Product Info */
    .product-info {
        padding: 20px 0;
    }
    
    .product-header {
        margin-bottom: 25px;
        padding-bottom: 25px;
        border-bottom: 1px solid var(--border-color);
    }
    
    .product-category {
        font-size: 0.9rem;
        color: var(--gold);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 10px;
        font-weight: 600;
    }
    
    .product-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 15px;
        line-height: 1.2;
        color: var(--text-primary);
    }
    
    .product-subtitle {
        font-size: 1.1rem;
        color: var(--text-secondary);
        line-height: 1.6;
        margin-bottom: 20px;
    }
    
    .product-meta {
        display: flex;
        align-items: center;
        gap: 30px;
        margin-top: 20px;
    }
    
    .product-rating {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .rating-stars {
        color: var(--gold);
        font-size: 1rem;
    }
    
    .rating-value {
        font-weight: 600;
        color: var(--text-primary);
    }
    
    .rating-count {
        color: var(--text-tertiary);
        font-size: 0.9rem;
    }
    
    .product-sku {
        font-size: 0.9rem;
        color: var(--text-tertiary);
    }
    
    .product-sku span {
        color: var(--text-primary);
        font-weight: 500;
    }
    
    /* Product Price */
    .product-price-section {
        margin-bottom: 30px;
        padding-bottom: 30px;
        border-bottom: 1px solid var(--border-color);
    }
    
    .price-container {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 15px;
    }
    
    .current-price {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--gold);
    }
    
    .original-price {
        font-size: 1.5rem;
        color: var(--text-tertiary);
        text-decoration: line-through;
    }
    
    .discount-badge {
        padding: 6px 12px;
        background: #ef4444;
        color: white;
        border-radius: var(--radius-full);
        font-size: 0.9rem;
        font-weight: 600;
    }
    
    .price-note {
        font-size: 0.9rem;
        color: var(--text-secondary);
    }
    
    /* Product Variants */
    .product-variants {
        margin-bottom: 30px;
    }
    
    .variant-group {
        margin-bottom: 25px;
    }
    
    .variant-label {
        display: block;
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 12px;
        color: var(--text-primary);
    }
    
    .variant-label .required {
        color: #ef4444;
    }
    
    .variant-options {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
    }
    
    .variant-option {
        position: relative;
    }
    
    .variant-input {
        position: absolute;
        opacity: 0;
    }
    
    .variant-label-btn {
        display: block;
        padding: 12px 24px;
        background: var(--surface-bg);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        font-size: 0.9rem;
        font-weight: 500;
        cursor: pointer;
        transition: all var(--transition-fast);
        min-width: 60px;
        text-align: center;
    }
    
    .variant-input:checked + .variant-label-btn {
        background: var(--gold);
        color: var(--text-inverse);
        border-color: var(--gold);
        box-shadow: var(--shadow-gold);
    }
    
    .variant-input:disabled + .variant-label-btn {
        opacity: 0.5;
        cursor: not-allowed;
    }
    
    .color-option {
        width: 44px;
        height: 44px;
        border-radius: var(--radius-full);
        position: relative;
        cursor: pointer;
        overflow: hidden;
    }
    
    .color-option .variant-label-btn {
        width: 100%;
        height: 100%;
        padding: 0;
        border-radius: var(--radius-full);
    }
    
    .color-option .variant-input:checked + .variant-label-btn::after {
        content: '✓';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 14px;
        font-weight: bold;
    }
    
    /* Product Actions */
    .product-actions {
        margin-bottom: 30px;
    }
    
    .quantity-selector {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 25px;
    }
    
    .quantity-label {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
        min-width: 100px;
    }
    
    .quantity-controls {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .quantity-btn {
        width: 44px;
        height: 44px;
        background: var(--surface-bg);
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        font-weight: 600;
        color: var(--text-primary);
        transition: all var(--transition-fast);
    }
    
    .quantity-btn:hover:not(:disabled) {
        background: var(--tertiary-bg);
    }
    
    .quantity-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
    
    .quantity-input {
        width: 70px;
        height: 44px;
        text-align: center;
        background: var(--surface-bg);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-primary);
    }
    
    .action-buttons {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 20px;
    }
    
    @media (max-width: 576px) {
        .action-buttons {
            grid-template-columns: 1fr;
        }
    }
    
    .btn-add-to-cart {
        grid-column: span 2;
        padding: 18px 30px;
        background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
        color: var(--text-inverse);
        border-radius: var(--radius-lg);
        font-size: 1.1rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        transition: all var(--transition-normal);
        box-shadow: var(--shadow-gold);
    }
    
    .btn-add-to-cart:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 30px rgba(212, 175, 55, 0.4);
    }
    
    .btn-buy-now {
        padding: 18px 30px;
        background: var(--surface-bg);
        color: var(--text-primary);
        border-radius: var(--radius-lg);
        font-size: 1.1rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        transition: all var(--transition-fast);
        border: 1px solid var(--border-color);
    }
    
    .btn-buy-now:hover {
        background: var(--tertiary-bg);
        transform: translateY(-3px);
        box-shadow: var(--shadow-md);
    }
    
    .secondary-actions {
        display: flex;
        gap: 10px;
    }
    
    .btn-secondary {
        flex: 1;
        padding: 12px;
        background: var(--surface-bg);
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        font-size: 0.9rem;
        font-weight: 500;
        color: var(--text-primary);
        transition: all var(--transition-fast);
    }
    
    .btn-secondary:hover {
        background: var(--tertiary-bg);
        transform: translateY(-2px);
    }
    
    /* Product Details */
    .product-details {
        margin-top: 40px;
    }
    
    .details-tabs {
        display: flex;
        gap: 2px;
        margin-bottom: 30px;
        border-bottom: 1px solid var(--border-color);
    }
    
    .tab-btn {
        padding: 15px 30px;
        background: transparent;
        color: var(--text-secondary);
        font-size: 1rem;
        font-weight: 600;
        position: relative;
        transition: all var(--transition-fast);
    }
    
    .tab-btn:hover {
        color: var(--text-primary);
    }
    
    .tab-btn.active {
        color: var(--gold);
    }
    
    .tab-btn.active::after {
        content: '';
        position: absolute;
        bottom: -1px;
        left: 0;
        width: 100%;
        height: 3px;
        background: linear-gradient(90deg, var(--gold) 0%, var(--gold-dark) 100%);
    }
    
    .tab-content {
        display: none;
    }
    
    .tab-content.active {
        display: block;
        animation: fadeIn 0.3s ease;
    }
    
    /* Description */
    .description-content {
        line-height: 1.8;
        color: var(--text-secondary);
    }
    
    .description-content h3 {
        font-size: 1.5rem;
        margin: 25px 0 15px;
        color: var(--text-primary);
    }
    
    .description-content p {
        margin-bottom: 15px;
    }
    
    .description-content ul {
        margin-left: 20px;
        margin-bottom: 20px;
    }
    
    .description-content li {
        margin-bottom: 8px;
        position: relative;
        padding-left: 20px;
    }
    
    .description-content li::before {
        content: '•';
        position: absolute;
        left: 0;
        color: var(--gold);
        font-size: 1.2rem;
    }
    
    /* Specifications */
    .specs-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .specs-table tr {
        border-bottom: 1px solid var(--border-light);
    }
    
    .specs-table tr:last-child {
        border-bottom: none;
    }
    
    .specs-table td {
        padding: 15px;
    }
    
    .specs-table td:first-child {
        width: 200px;
        font-weight: 600;
        color: var(--text-primary);
    }
    
    .specs-table td:last-child {
        color: var(--text-secondary);
    }
    
    /* Reviews */
    .reviews-summary {
        display: flex;
        gap: 40px;
        margin-bottom: 40px;
        padding: 30px;
        background: var(--card-bg);
        border-radius: var(--radius-xl);
    }
    
    .rating-overview {
        text-align: center;
        min-width: 180px;
    }
    
    .average-rating {
        font-size: 3.5rem;
        font-weight: 700;
        color: var(--gold);
        margin-bottom: 10px;
    }
    
    .rating-stars-large {
        font-size: 1.5rem;
        color: var(--gold);
        margin-bottom: 10px;
    }
    
    .total-reviews {
        color: var(--text-tertiary);
        font-size: 0.9rem;
    }
    
    .rating-bars {
        flex: 1;
    }
    
    .rating-bar {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 12px;
    }
    
    .rating-label {
        min-width: 80px;
        font-size: 0.9rem;
        color: var(--text-secondary);
    }
    
    .rating-progress {
        flex: 1;
        height: 8px;
        background: var(--surface-bg);
        border-radius: 4px;
        overflow: hidden;
    }
    
    .rating-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--gold) 0%, var(--gold-dark) 100%);
    }
    
    .rating-count {
        min-width: 40px;
        text-align: right;
        font-size: 0.9rem;
        color: var(--text-tertiary);
    }
    
    .review-list {
        display: flex;
        flex-direction: column;
        gap: 25px;
    }
    
    .review-item {
        padding: 25px;
        background: var(--card-bg);
        border-radius: var(--radius-xl);
    }
    
    .review-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
    }
    
    .reviewer-info {
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    .reviewer-avatar {
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, var(--gold) 0%, var(--rose-gold) 100%);
        border-radius: var(--radius-full);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: var(--text-inverse);
    }
    
    .reviewer-details h4 {
        font-size: 1.1rem;
        margin-bottom: 5px;
        color: var(--text-primary);
    }
    
    .reviewer-verified {
        display: flex;
        align-items: center;
        gap: 5px;
        font-size: 0.8rem;
        color: #10b981;
    }
    
    .review-rating {
        display: flex;
        gap: 5px;
        color: var(--gold);
    }
    
    .review-date {
        font-size: 0.85rem;
        color: var(--text-tertiary);
        margin-top: 5px;
    }
    
    .review-content {
        color: var(--text-secondary);
        line-height: 1.6;
    }
    
    /* Similar Products */
    .similar-products {
        margin-top: 80px;
    }
    
    .section-header {
        margin-bottom: 40px;
    }
    
    .section-title {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 15px;
        color: var(--text-primary);
    }
    
    .section-subtitle {
        font-size: 1.1rem;
        color: var(--text-secondary);
        max-width: 600px;
    }
    
    .similar-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 30px;
    }
    
    /* Product Badges */
    .product-badges {
        position: absolute;
        top: 20px;
        left: 20px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        z-index: 2;
    }
    
    .product-badge {
        padding: 8px 16px;
        border-radius: var(--radius-full);
        font-size: 0.8rem;
        font-weight: 600;
        letter-spacing: 0.5px;
        text-transform: uppercase;
    }
    
    .badge-new {
        background: #10b981;
        color: white;
    }
    
    .badge-exclusive {
        background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
        color: white;
    }
    
    .badge-limited {
        background: #8b5cf6;
        color: white;
    }
    
    .badge-sale {
        background: #ef4444;
        color: white;
    }
    
    /* Stock Status */
    .stock-status {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        border-radius: var(--radius-full);
        font-size: 0.9rem;
        font-weight: 500;
        margin-top: 10px;
    }
    
    .in-stock {
        background: rgba(16, 185, 129, 0.1);
        color: #10b981;
    }
    
    .low-stock {
        background: rgba(245, 158, 11, 0.1);
        color: #f59e0b;
    }
    
    .out-of-stock {
        background: rgba(239, 68, 68, 0.1);
        color: #ef4444;
    }
    
    /* Zoom Modal */
    .zoom-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        visibility: hidden;
        transition: all var(--transition-normal);
    }
    
    .zoom-modal.active {
        opacity: 1;
        visibility: visible;
    }
    
    .zoom-content {
        position: relative;
        max-width: 90%;
        max-height: 90%;
    }
    
    .zoom-image {
        max-width: 100%;
        max-height: 90vh;
        object-fit: contain;
    }
    
    .zoom-close {
        position: absolute;
        top: 20px;
        right: 20px;
        width: 44px;
        height: 44px;
        background: var(--card-bg);
        border-radius: var(--radius-full);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: var(--text-primary);
        transition: all var(--transition-fast);
    }
    
    .zoom-close:hover {
        background: var(--gold);
        color: var(--text-inverse);
        transform: rotate(90deg);
    }
    
    .zoom-nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 44px;
        height: 44px;
        background: var(--card-bg);
        border-radius: var(--radius-full);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: var(--text-primary);
        transition: all var(--transition-fast);
    }
    
    .zoom-nav:hover {
        background: var(--gold);
        color: var(--text-inverse);
    }
    
    .zoom-prev {
        left: 20px;
    }
    
    .zoom-next {
        right: 20px;
    }
    
    /* Responsive */
    @media (max-width: 1200px) {
        .product-title {
            font-size: 2rem;
        }
        
        .gallery-image {
            height: 500px;
        }
    }
    
    @media (max-width: 768px) {
        .product-title {
            font-size: 1.75rem;
        }
        
        .gallery-image {
            height: 400px;
        }
        
        .reviews-summary {
            flex-direction: column;
            gap: 25px;
        }
        
        .rating-overview {
            min-width: auto;
        }
        
        .action-buttons {
            grid-template-columns: 1fr;
        }
        
        .btn-add-to-cart {
            grid-column: span 1;
        }
    }
    
    @media (max-width: 576px) {
        .product-title {
            font-size: 1.5rem;
        }
        
        .gallery-image {
            height: 350px;
        }
        
        .gallery-thumbs {
            grid-template-columns: repeat(3, 1fr);
        }
        
        .current-price {
            font-size: 2rem;
        }
        
        .details-tabs {
            overflow-x: auto;
            flex-wrap: nowrap;
        }
        
        .tab-btn {
            padding: 12px 20px;
            white-space: nowrap;
        }
    }
    
    /* Animations */
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
{% endblock %}

{% block content %}
    <!-- Product Page -->
    <div class="product-page">
        <div class="container">
            <!-- Breadcrumb -->
            <nav class="product-breadcrumb">
                <ol class="breadcrumb-list">
                    <li class="breadcrumb-item">
                        <a href="{{ url_for('index') }}" class="breadcrumb-link">
                            <i class="fas fa-home"></i>
                            <span>Главная</span>
                        </a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="{{ url_for('catalog_page') }}" class="breadcrumb-link">Каталог</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="{{ url_for('catalog_page', category=product.category) }}" class="breadcrumb-link">{{ product.category }}</a>
                    </li>
                    <li class="breadcrumb-item">
                        <span class="breadcrumb-current">{{ product.name|truncate(30) }}</span>
                    </li>
                </ol>
            </nav>
            
            <!-- Product Layout -->
            <div class="product-layout">
                <!-- Gallery -->
                <div class="product-gallery">
                    <div class="gallery-main">
                        <div class="product-badges">
                            {% if product.is_new %}
                            <span class="product-badge badge-new">Новинка</span>
                            {% endif %}
                            {% if product.is_exclusive %}
                            <span class="product-badge badge-exclusive">Эксклюзив</span>
                            {% endif %}
                            {% if product.is_limited %}
                            <span class="product-badge badge-limited">Лимитированная</span>
                            {% endif %}
                            {% if product.discount > 0 %}
                            <span class="product-badge badge-sale">-{{ product.discount }}%</span>
                            {% endif %}
                        </div>
                        
                        <img src="{{ product.image_url or 'https://images.unsplash.com/photo-1595777457583-95e059d581b8?w=800&h=1200&fit=crop&q=80' }}" 
                             alt="{{ product.name }}" 
                             class="gallery-image" 
                             id="main-image">
                        
                        <div class="gallery-actions">
                            <button class="gallery-btn" title="Увеличить" id="zoom-btn">
                                <i class="fas fa-search-plus"></i>
                            </button>
                            <button class="gallery-btn" title="В избранное" id="wishlist-btn">
                                <i class="far fa-heart"></i>
                            </button>
                            <button class="gallery-btn" title="Сравнить" id="compare-btn">
                                <i class="fas fa-exchange-alt"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="gallery-thumbs" id="thumbnail-container">
                        {% set images = product.images|from_json if product.images else [] %}
                        {% for i in range(4) %}
                        <div class="thumb-item {% if loop.first %}active{% endif %}" data-index="{{ loop.index0 }}">
                            {% if images and images[i] %}
                            <img src="{{ images[i] }}" alt="{{ product.name }} - вид {{ loop.index }}" class="thumb-image">
                            {% else %}
                            <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: var(--surface-bg);">
                                <i class="fas fa-image" style="font-size: 24px; color: var(--border-color);"></i>
                            </div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- Info -->
                <div class="product-info">
                    <div class="product-header">
                        <div class="product-category">{{ product.category }}</div>
                        <h1 class="product-title">{{ product.name }}</h1>
                        <p class="product-subtitle">{{ product.description }}</p>
                        
                        <div class="product-meta">
                            <div class="product-rating">
                                <div class="rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                                <span class="rating-value">4.7</span>
                                <span class="rating-count">({{ (product.id % 100) + 24 }} отзывов)</span>
                            </div>
                            
                            <div class="product-sku">
                                Артикул: <span>{{ product.article }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Stock Status -->
                    <div class="stock-status {% if product.stock > 10 %}in-stock{% elif product.stock > 0 %}low-stock{% else %}out-of-stock{% endif %}">
                        <i class="fas {% if product.stock > 10 %}fa-check-circle{% elif product.stock > 0 %}fa-exclamation-circle{% else %}fa-times-circle{% endif %}"></i>
                        <span>
                            {% if product.stock > 10 %}
                            В наличии ({{ product.stock }} шт.)
                            {% elif product.stock > 0 %}
                            Мало осталось ({{ product.stock }} шт.)
                            {% else %}
                            Нет в наличии
                            {% endif %}
                        </span>
                    </div>
                    
                    <!-- Price -->
                    <div class="product-price-section">
                        <div class="price-container">
                            <div class="current-price">
                                {% if product.discount > 0 %}
                                {{ (product.price * (100 - product.discount) / 100)|int }} €
                                {% else %}
                                {{ product.price }} €
                                {% endif %}
                            </div>
                            
                            {% if product.discount > 0 %}
                            <div class="original-price">{{ product.price }} €</div>
                            <div class="discount-badge">-{{ product.discount }}%</div>
                            {% endif %}
                        </div>
                        
                        <p class="price-note">Цена включает НДС и все налоги. Бесплатная доставка от 20 000 €</p>
                    </div>
                    
                    <!-- Variants -->
                    <div class="product-variants">
                        {% if product.size %}
                        <div class="variant-group">
                            <label class="variant-label">
                                Размер <span class="required">*</span>
                            </label>
                            <div class="variant-options">
                                {% set sizes = product.size.split(',') %}
                                {% for size in sizes %}
                                <div class="variant-option">
                                    <input type="radio" 
                                           name="size" 
                                           value="{{ size.strip() }}" 
                                           id="size-{{ size.strip() }}" 
                                           class="variant-input"
                                           {% if loop.first %}checked{% endif %}
                                           {% if product.stock <= 0 %}disabled{% endif %}>
                                    <label for="size-{{ size.strip() }}" class="variant-label-btn">
                                        {{ size.strip() }}
                                    </label>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                        
                        {% if product.color %}
                        <div class="variant-group">
                            <label class="variant-label">
                                Цвет <span class="required">*</span>
                            </label>
                            <div class="variant-options">
                                {% set colors = product.color.split(',') %}
                                {% for color in colors %}
                                <div class="variant-option color-option">
                                    <input type="radio" 
                                           name="color" 
                                           value="{{ color.strip() }}" 
                                           id="color-{{ color.strip() }}" 
                                           class="variant-input"
                                           {% if loop.first %}checked{% endif %}>
                                    <label for="color-{{ color.strip() }}" 
                                           class="variant-label-btn"
                                           style="background: {{ get_color_hex(color.strip()) }}">
                                    </label>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Actions -->
                    <div class="product-actions">
                        <div class="quantity-selector">
                            <div class="quantity-label">Количество:</div>
                            <div class="quantity-controls">
                                <button class="quantity-btn" id="decrease-qty" {% if product.stock <= 0 %}disabled{% endif %}>
                                    <i class="fas fa-minus"></i>
                                </button>
                                <input type="number" 
                                       class="quantity-input" 
                                       id="quantity" 
                                       value="1" 
                                       min="1" 
                                       max="{{ product.stock }}"
                                       {% if product.stock <= 0 %}disabled{% endif %}>
                                <button class="quantity-btn" id="increase-qty" {% if product.stock <= 0 %}disabled{% endif %}>
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn-add-to-cart" id="add-to-cart-btn" {% if product.stock <= 0 %}disabled{% endif %}>
                                <i class="fas fa-shopping-bag"></i>
                                <span>Добавить в корзину</span>
                            </button>
                            
                            <button class="btn-buy-now" id="buy-now-btn" {% if product.stock <= 0 %}disabled{% endif %}>
                                <i class="fas fa-bolt"></i>
                                <span>Купить сейчас</span>
                            </button>
                        </div>
                        
                        <div class="secondary-actions">
                            <button class="btn-secondary" id="add-to-wishlist">
                                <i class="far fa-heart"></i>
                                <span>В избранное</span>
                            </button>
                            <button class="btn-secondary" id="add-to-compare">
                                <i class="fas fa-exchange-alt"></i>
                                <span>Сравнить</span>
                            </button>
                            <button class="btn-secondary" id="share-product">
                                <i class="fas fa-share-alt"></i>
                                <span>Поделиться</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Details Tabs -->
                    <div class="product-details">
                        <div class="details-tabs">
                            <button class="tab-btn active" data-tab="description">Описание</button>
                            <button class="tab-btn" data-tab="specifications">Характеристики</button>
                            <button class="tab-btn" data-tab="reviews">Отзывы (24)</button>
                            <button class="tab-btn" data-tab="shipping">Доставка и возврат</button>
                        </div>
                        
                        <!-- Description Tab -->
                        <div class="tab-content active" id="description-content">
                            <div class="description-content">
                                {{ product.detailed_description|safe if product.detailed_description else '
                                <h3>Эксклюзивное предложение</h3>
                                <p>Этот товар является частью лимитированной коллекции, созданной специально для ценителей высокой моды и роскоши.</p>
                                
                                <h3>Детали и материалы</h3>
                                <p>Изготовлено из премиальных материалов высочайшего качества:</p>
                                <ul>
                                    <li>Натуральный шелк класса люкс</li>
                                    <li>Французское кружево ручной работы</li>
                                    <li>Платиновая фурнитура</li>
                                    <li>Эксклюзивная вышивка золотой нитью</li>
                                </ul>
                                
                                <h3>Уход за изделием</h3>
                                <p>Рекомендуется химчистка. Беречь от прямых солнечных лучей. Хранить в специальном чехле.</p>
                                
                                <h3>Гарантия качества</h3>
                                <p>Все изделия проходят строгий контроль качества. Гарантия 2 года от производителя.</p>
                                ' }}
                            </div>
                        </div>
                        
                        <!-- Specifications Tab -->
                        <div class="tab-content" id="specifications-content">
                            <table class="specs-table">
                                <tr>
                                    <td>Бренд</td>
                                    <td>{{ product.brand or 'VOGUE ÉLITE' }}</td>
                                </tr>
                                <tr>
                                    <td>Артикул</td>
                                    <td>{{ product.article }}</td>
                                </tr>
                                <tr>
                                    <td>Категория</td>
                                    <td>{{ product.category }}</td>
                                </tr>
                                {% if product.subcategory %}
                                <tr>
                                    <td>Подкатегория</td>
                                    <td>{{ product.subcategory }}</td>
                                </tr>
                                {% endif %}
                                <tr>
                                    <td>Материал</td>
                                    <td>{{ product.material or 'Шелк, кружево' }}</td>
                                </tr>
                                <tr>
                                    <td>Цвет</td>
                                    <td>{{ product.color or 'Черный' }}</td>
                                </tr>
                                <tr>
                                    <td>Размеры</td>
                                    <td>{{ product.size or 'XS, S, M, L, XL' }}</td>
                                </tr>
                                <tr>
                                    <td>Страна производства</td>
                                    <td>{{ product.country or 'Италия' }}</td>
                                </tr>
                                <tr>
                                    <td>Сезон</td>
                                    <td>{{ product.season or 'Всесезонный' }}</td>
                                </tr>
                                {% if product.weight %}
                                <tr>
                                    <td>Вес</td>
                                    <td>{{ product.weight }} кг</td>
                                </tr>
                                {% endif %}
                                {% if product.dimensions %}
                                <tr>
                                    <td>Размеры упаковки</td>
                                    <td>{{ product.dimensions }}</td>
                                </tr>
                                {% endif %}
                            </table>
                        </div>
                        
                        <!-- Reviews Tab -->
                        <div class="tab-content" id="reviews-content">
                            <div class="reviews-summary">
                                <div class="rating-overview">
                                    <div class="average-rating">4.7</div>
                                    <div class="rating-stars-large">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star-half-alt"></i>
                                    </div>
                                    <div class="total-reviews">На основе 24 отзывов</div>
                                </div>
                                
                                <div class="rating-bars">
                                    <div class="rating-bar">
                                        <span class="rating-label">5 звезд</span>
                                        <div class="rating-progress">
                                            <div class="rating-fill" style="width: 75%;"></div>
                                        </div>
                                        <span class="rating-count">18</span>
                                    </div>
                                    <div class="rating-bar">
                                        <span class="rating-label">4 звезды</span>
                                        <div class="rating-progress">
                                            <div class="rating-fill" style="width: 17%;"></div>
                                        </div>
                                        <span class="rating-count">4</span>
                                    </div>
                                    <div class="rating-bar">
                                        <span class="rating-label">3 звезды</span>
                                        <div class="rating-progress">
                                            <div class="rating-fill" style="width: 4%;"></div>
                                        </div>
                                        <span class="rating-count">1</span>
                                    </div>
                                    <div class="rating-bar">
                                        <span class="rating-label">2 звезды</span>
                                        <div class="rating-progress">
                                            <div class="rating-fill" style="width: 0%;"></div>
                                        </div>
                                        <span class="rating-count">0</span>
                                    </div>
                                    <div class="rating-bar">
                                        <span class="rating-label">1 звезда</span>
                                        <div class="rating-progress">
                                            <div class="rating-fill" style="width: 4%;"></div>
                                        </div>
                                        <span class="rating-count">1</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="review-list">
                                <div class="review-item">
                                    <div class="review-header">
                                        <div class="reviewer-info">
                                            <div class="reviewer-avatar">
                                                <i class="fas fa-user"></i>
                                            </div>
                                            <div class="reviewer-details">
                                                <h4>Анна Петрова</h4>
                                                <div class="reviewer-verified">
                                                    <i class="fas fa-check-circle"></i>
                                                    <span>Покупка подтверждена</span>
                                                </div>
                                                <div class="review-rating">
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="review-date">15 января 2024</div>
                                    </div>
                                    <div class="review-content">
                                        <p>Исключительное качество! Платье превзошло все ожидания. Материал роскошный, посадка идеальная. Спасибо за прекрасный сервис и быструю доставку!</p>
                                    </div>
                                </div>
                                
                                <div class="review-item">
                                    <div class="review-header">
                                        <div class="reviewer-info">
                                            <div class="reviewer-avatar">
                                                <i class="fas fa-user"></i>
                                            </div>
                                            <div class="reviewer-details">
                                                <h4>Мария Иванова</h4>
                                                <div class="reviewer-verified">
                                                    <i class="fas fa-check-circle"></i>
                                                    <span>Покупка подтверждена</span>
                                                </div>
                                                <div class="review-rating">
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="far fa-star"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="review-date">10 декабря 2023</div>
                                    </div>
                                    <div class="review-content">
                                        <p>Очень красивое платье, но размер оказался немного мал. Обменяли без проблем. Качество ткани и отделки на высшем уровне!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Shipping Tab -->
                        <div class="tab-content" id="shipping-content">
                            <div class="description-content">
                                <h3>Доставка</h3>
                                <p>Мы предлагаем различные варианты доставки по всему миру:</p>
                                <ul>
                                    <li><strong>VIP доставка:</strong> 1-2 рабочих дня – бесплатно при заказе от 20 000 €</li>
                                    <li><strong>Экспресс доставка:</strong> 3-5 рабочих дней – 50 €</li>
                                    <li><strong>Стандартная доставка:</strong> 7-14 рабочих дней – 30 €</li>
                                    <li><strong>Международная доставка:</strong> Доставляем в более чем 50 стран</li>
                                </ul>
                                
                                <h3>Возврат и обмен</h3>
                                <p>Мы гарантируем легкий возврат в течение 30 дней с момента получения заказа:</p>
                                <ul>
                                    <li>Товар должен быть в оригинальном состоянии</li>
                                    <li>Должны быть сохранены все бирки и упаковка</li>
                                    <li>Возврат осуществляется за наш счет</li>
                                    <li>Деньги возвращаются в течение 3-5 рабочих дней</li>
                                </ul>
                                
                                <h3>Гарантия</h3>
                                <p>На все товары предоставляется гарантия 2 года от производителя. При обнаружении производственного брака мы немедленно заменим товар или вернем деньги.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Similar Products -->
            {% if similar_products %}
            <section class="similar-products">
                <div class="section-header">
                    <h2 class="section-title">Похожие товары</h2>
                    <p class="section-subtitle">Другие товары из этой категории, которые могут вам понравиться</p>
                </div>
                
                <div class="similar-grid">
                    {% for similar in similar_products %}
                    <div class="product-card">
                        {% if similar.is_new %}
                        <div class="product-badges">
                            <span class="product-badge badge-new">Новинка</span>
                        </div>
                        {% endif %}
                        
                        <div class="product-image">
                            <img src="{{ similar.image_url or 'https://images.unsplash.com/photo-1595777457583-95e059d581b8?w=800&h=1200&fit=crop&q=80' }}" alt="{{ similar.name }}">
                            <div class="product-actions">
                                <button class="action-btn" title="В избранное">
                                    <i class="far fa-heart"></i>
                                </button>
                                <button class="action-btn" title="Быстрый просмотр">
                                    <i class="far fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="product-info">
                            <div class="product-category">{{ similar.category }}</div>
                            <h3 class="product-title">{{ similar.name|truncate(40) }}</h3>
                            <div class="product-meta">
                                <div class="product-price">
                                    <span class="current-price">{{ similar.price }} €</span>
                                </div>
                            </div>
                            <div class="product-footer">
                                <button class="btn-add-cart" data-product-id="{{ similar.id }}">
                                    <i class="fas fa-shopping-bag"></i>
                                    <span>В корзину</span>
                                </button>
                                <a href="{{ url_for('product_detail', product_id=similar.id) }}" class="btn-view" title="Подробнее">
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}
        </div>
    </div>
    
    <!-- Zoom Modal -->
    <div class="zoom-modal" id="zoom-modal">
        <div class="zoom-content">
            <img src="" alt="" class="zoom-image" id="zoom-image">
            <button class="zoom-close" id="zoom-close">
                <i class="fas fa-times"></i>
            </button>
            <button class="zoom-nav zoom-prev" id="zoom-prev">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="zoom-nav zoom-next" id="zoom-next">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Thumbnail Gallery
        const mainImage = document.getElementById('main-image');
        const thumbItems = document.querySelectorAll('.thumb-item');
        const thumbnailImages = [];
        
        // Collect all thumbnail images
        thumbItems.forEach(item => {
            const img = item.querySelector('img');
            if (img) {
                thumbnailImages.push(img.src);
            } else {
                // Use placeholder or main image
                thumbnailImages.push(mainImage.src);
            }
        });
        
        thumbItems.forEach((item, index) => {
            item.addEventListener('click', function() {
                // Update active thumbnail
                thumbItems.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Update main image
                if (thumbnailImages[index]) {
                    mainImage.src = thumbnailImages[index];
                }
            });
        });
        
        // Quantity Controls
        const quantityInput = document.getElementById('quantity');
        const decreaseBtn = document.getElementById('decrease-qty');
        const increaseBtn = document.getElementById('increase-qty');
        const maxStock = parseInt('{{ product.stock }}');
        
        decreaseBtn.addEventListener('click', function() {
            let value = parseInt(quantityInput.value);
            if (value > 1) {
                quantityInput.value = value - 1;
                updateButtons();
            }
        });
        
        increaseBtn.addEventListener('click', function() {
            let value = parseInt(quantityInput.value);
            if (value < maxStock) {
                quantityInput.value = value + 1;
                updateButtons();
            }
        });
        
        quantityInput.addEventListener('change', function() {
            let value = parseInt(this.value);
            if (isNaN(value) || value < 1) {
                this.value = 1;
            } else if (value > maxStock) {
                this.value = maxStock;
            }
            updateButtons();
        });
        
        function updateButtons() {
            const value = parseInt(quantityInput.value);
            decreaseBtn.disabled = value <= 1;
            increaseBtn.disabled = value >= maxStock;
        }
        
        updateButtons();
        
        // Tab Switching
        const tabButtons = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Update active tab button
                tabButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Show corresponding content
                tabContents.forEach(content => {
                    content.classList.remove('active');
                    if (content.id === tabId + '-content') {
                        content.classList.add('active');
                    }
                });
            });
        });
        
        // Add to Cart
        const addToCartBtn = document.getElementById('add-to-cart-btn');
        const buyNowBtn = document.getElementById('buy-now-btn');
        const notification = document.getElementById('notification');
        const notificationMessage = document.getElementById('notification-message');
        
        function addToCart(action = 'add') {
            const quantity = parseInt(quantityInput.value);
            const size = document.querySelector('input[name="size"]:checked')?.value;
            const color = document.querySelector('input[name="color"]:checked')?.value;
            
            // Validate selection
            if (!size || !color) {
                notificationMessage.textContent = 'Пожалуйста, выберите размер и цвет';
                notification.classList.add('show');
                setTimeout(() => notification.classList.remove('show'), 3000);
                return;
            }
            
            // Update cart count
            const cartCountElement = document.getElementById('cart-count');
            const mobileCartCountElement = document.getElementById('mobile-cart-count');
            
            if (cartCountElement) {
                let currentCount = parseInt(cartCountElement.textContent) || 0;
                currentCount += quantity;
                cartCountElement.textContent = currentCount;
                
                if (mobileCartCountElement) {
                    mobileCartCountElement.textContent = currentCount;
                }
            }
            
            // Show success notification
            notificationMessage.textContent = action === 'add' 
                ? 'Товар добавлен в корзину!' 
                : 'Переходим к оформлению заказа...';
            notification.classList.add('show');
            
            // Button feedback for add to cart
            if (action === 'add') {
                const icon = addToCartBtn.querySelector('i');
                const originalIcon = icon.className;
                const originalText = addToCartBtn.querySelector('span').textContent;
                
                icon.className = 'fas fa-check';
                addToCartBtn.querySelector('span').textContent = 'Добавлено!';
                addToCartBtn.style.background = '#10b981';
                
                setTimeout(() => {
                    icon.className = originalIcon;
                    addToCartBtn.querySelector('span').textContent = originalText;
                    addToCartBtn.style.background = '';
                }, 2000);
            }
            
            // Auto hide notification
            setTimeout(() => {
                notification.classList.remove('show');
                if (action === 'buy') {
                    // Redirect to checkout
                    window.location.href = '{{ url_for("checkout") }}';
                }
            }, 2000);
            
            // Send to server
            fetch('/api/cart/add', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    product_id: {{ product.id }},
                    quantity: quantity,
                    size: size,
                    color: color
                }),
                credentials: 'include'
            }).catch(error => {
                console.error('Error adding to cart:', error);
            });
        }
        
        addToCartBtn.addEventListener('click', () => addToCart('add'));
        buyNowBtn.addEventListener('click', () => addToCart('buy'));
        
        // Wishlist
        const wishlistBtn = document.getElementById('add-to-wishlist');
        const galleryWishlistBtn = document.getElementById('wishlist-btn');
        
        function toggleWishlist() {
            const isActive = wishlistBtn.classList.contains('active');
            
            if (isActive) {
                wishlistBtn.classList.remove('active');
                wishlistBtn.querySelector('i').className = 'far fa-heart';
                wishlistBtn.querySelector('span').textContent = 'В избранное';
                galleryWishlistBtn.querySelector('i').className = 'far fa-heart';
                
                notificationMessage.textContent = 'Товар удален из избранного';
            } else {
                wishlistBtn.classList.add('active');
                wishlistBtn.querySelector('i').className = 'fas fa-heart';
                wishlistBtn.querySelector('span').textContent = 'В избранном';
                galleryWishlistBtn.querySelector('i').className = 'fas fa-heart';
                
                notificationMessage.textContent = 'Товар добавлен в избранное';
            }
            
            notification.classList.add('show');
            setTimeout(() => notification.classList.remove('show'), 3000);
        }
        
        wishlistBtn.addEventListener('click', toggleWishlist);
        galleryWishlistBtn.addEventListener('click', toggleWishlist);
        
        // Compare
        const compareBtn = document.getElementById('add-to-compare');
        const galleryCompareBtn = document.getElementById('compare-btn');
        
        [compareBtn, galleryCompareBtn].forEach(btn => {
            btn.addEventListener('click', function() {
                notificationMessage.textContent = 'Товар добавлен к сравнению';
                notification.classList.add('show');
                setTimeout(() => notification.classList.remove('show'), 3000);
            });
        });
        
        // Share
        const shareBtn = document.getElementById('share-product');
        shareBtn.addEventListener('click', function() {
            if (navigator.share) {
                navigator.share({
                    title: '{{ product.name }}',
                    text: 'Посмотрите этот товар в VOGUE ÉLITE',
                    url: window.location.href,
                });
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(window.location.href);
                notificationMessage.textContent = 'Ссылка скопирована в буфер обмена';
                notification.classList.add('show');
                setTimeout(() => notification.classList.remove('show'), 3000);
            }
        });
        
        // Zoom functionality
        const zoomBtn = document.getElementById('zoom-btn');
        const zoomModal = document.getElementById('zoom-modal');
        const zoomImage = document.getElementById('zoom-image');
        const zoomClose = document.getElementById('zoom-close');
        const zoomPrev = document.getElementById('zoom-prev');
        const zoomNext = document.getElementById('zoom-next');
        
        let currentImageIndex = 0;
        
        zoomBtn.addEventListener('click', function() {
            zoomImage.src = mainImage.src;
            currentImageIndex = Array.from(thumbItems).findIndex(t => t.classList.contains('active'));
            zoomModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
        
        zoomClose.addEventListener('click', function() {
            zoomModal.classList.remove('active');
            document.body.style.overflow = '';
        });
        
        zoomModal.addEventListener('click', function(e) {
            if (e.target === zoomModal) {
                zoomModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });
        
        zoomPrev.addEventListener('click', function() {
            currentImageIndex = (currentImageIndex - 1 + thumbnailImages.length) % thumbnailImages.length;
            zoomImage.src = thumbnailImages[currentImageIndex];
            updateActiveThumb();
        });
        
        zoomNext.addEventListener('click', function() {
            currentImageIndex = (currentImageIndex + 1) % thumbnailImages.length;
            zoomImage.src = thumbnailImages[currentImageIndex];
            updateActiveThumb();
        });
        
        function updateActiveThumb() {
            thumbItems.forEach((item, index) => {
                item.classList.toggle('active', index === currentImageIndex);
            });
            mainImage.src = thumbnailImages[currentImageIndex];
        }
        
        // Keyboard navigation for zoom
        document.addEventListener('keydown', function(e) {
            if (zoomModal.classList.contains('active')) {
                if (e.key === 'Escape') {
                    zoomModal.classList.remove('active');
                    document.body.style.overflow = '';
                } else if (e.key === 'ArrowLeft') {
                    zoomPrev.click();
                } else if (e.key === 'ArrowRight') {
                    zoomNext.click();
                }
            }
        });
        
        // Product variants validation
        const variantInputs = document.querySelectorAll('.variant-input');
        variantInputs.forEach(input => {
            input.addEventListener('change', function() {
                // Update any dependent logic here
                console.log('Variant changed:', this.name, this.value);
            });
        });
        
        // Initialize tooltips
        const tooltipElements = document.querySelectorAll('[title]');
        tooltipElements.forEach(el => {
            el.addEventListener('mouseenter', function(e) {
                const title = this.getAttribute('title');
                if (title) {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'custom-tooltip';
                    tooltip.textContent = title;
                    document.body.appendChild(tooltip);
                    
                    const rect = this.getBoundingClientRect();
                    tooltip.style.left = rect.left + rect.width / 2 - tooltip.offsetWidth / 2 + 'px';
                    tooltip.style.top = rect.top - tooltip.offsetHeight - 10 + 'px';
                    
                    this.setAttribute('title', '');
                }
            });
            
            el.addEventListener('mouseleave', function() {
                const tooltips = document.querySelectorAll('.custom-tooltip');
                tooltips.forEach(t => t.remove());
                const title = this.getAttribute('data-original-title') || this.getAttribute('title');
                if (title) {
                    this.setAttribute('title', title);
                }
            });
        });
    });
</script>
{% endblock %}